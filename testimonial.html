<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Biblioteca de PDFs | Enciclopedia de Animales Mexicanos</title>
  <!-- Bootstrap base (opcional) -->
  <link rel="stylesheet" href="css/bootstrap.min.css"/>
  <style>
    /* ====== Design tokens ====== */
    :root{
      --bg:#f7faf7;          /* fondo cálido */
      --surface:#ffffff;     /* cartas */
      --ink:#0f172a;         /* texto base */
      --muted:#6b7280;       /* texto secundario */
      --line:#e5e7eb;        /* bordes sutiles */

      /* PRIMARIO VERDE */
      --accent:#16a34a;      /* verde 600 */
      --accent-600:#15803d;  /* verde 700 */
      --accent-700:#166534;  /* verde 800 */

      --success:#16a34a;     /* verde naturaleza */
      --warn:#b45309;
      --radius:16px;
      --shadow:0 10px 25px rgba(2,6,23,.08), 0 2px 8px rgba(2,6,23,.06);
      --shadow-sm:0 6px 18px rgba(2,6,23,.08);
      --trans:220ms cubic-bezier(.22,1,.36,1);
    }

    /* ====== Base ====== */
    html,body{height:100%}
    body{margin:0; background:var(--bg); color:var(--ink); -webkit-font-smoothing:antialiased;}
    img{max-width:100%; height:auto; display:block}
    a{color:var(--accent); text-decoration:none}
    a:hover{color:var(--accent-700)}
    .container{max-width:1200px}

    /* ====== Header ====== */
    .site-header{position:sticky; top:0; z-index:50; background:linear-gradient(180deg,#ffffff, #f9fbff); border-bottom:1px solid var(--line);}
    .mast{display:flex; align-items:center; justify-content:space-between; gap:1rem; padding:.85rem 0}
    .brand{display:flex; align-items:center; gap:.75rem}
    .brand img{width:44px; height:44px; object-fit:contain}
    .brand .title{font-weight:700; letter-spacing:.2px}
    .brand .sub{color:var(--muted); font-size:.9rem}

    .nav{display:flex; align-items:center; gap:.5rem; flex-wrap:wrap}
    .nav a{padding:.5rem .75rem; border-radius:10px; color:#0f172a}
    /* activo/hover en VERDE */
    .nav a[aria-current="page"], .nav a:hover{background:#ecfdf5; color:var(--accent)}

    /* ====== Hero / Page head ====== */
    /* degradé sutil 100% verde */
    .hero{
      position:relative; overflow:hidden;
      background:
        radial-gradient(1200px 400px at 10% -10%, #e8fff2 0%, transparent 60%),
        radial-gradient(1000px 400px at 90% -20%, #f0fff7 0%, transparent 60%);
    }
    .hero-inner{padding:2rem 0 1.25rem;}
    .hero h1{font-size:clamp(1.35rem, 2vw + 1rem, 2rem); margin:0 0 .25rem;}
    .hero p{margin:0; color:var(--muted)}

    /* ====== Toolbar (search + filtros) ====== */
    .toolbar{display:grid; grid-template-columns: 1fr auto; gap:1rem; padding:1rem 0 0}
    @media (max-width: 640px){ .toolbar{grid-template-columns: 1fr} }

    .search{display:flex; align-items:center; gap:.5rem; background:var(--surface); border:1px solid var(--line); border-radius:999px; padding:.5rem .75rem; box-shadow:var(--shadow-sm)}
    .search svg{flex:0 0 auto}
    .search input{border:0; outline:0; width:100%; background:transparent; font-size:1rem}
    .search .kbd{display:inline-flex; align-items:center; gap:.25rem; font-size:.8rem; color:var(--muted); background:#f4f6f9; border:1px solid var(--line); padding:.15rem .35rem; border-radius:6px}

    .tools{display:flex; align-items:center; gap:.5rem; flex-wrap:wrap}
    .select{border:1px solid var(--line); background:var(--surface); border-radius:10px; padding:.55rem .7rem}
    .btn{display:inline-flex; align-items:center; gap:.5rem; padding:.55rem .8rem; border-radius:10px; border:1px solid var(--line); background:var(--surface); cursor:pointer; transition:transform var(--trans), background var(--trans);}
    .btn:hover{transform:translateY(-1px); background:#f1fcf5}

    /* Tag chips (VERDE) */
    .chips{display:flex; gap:.5rem; flex-wrap:wrap; margin-top:.75rem}
    .chip{
      display:inline-flex; align-items:center; gap:.35rem;
      border:1px solid #bbf7d0;       /* borde verde claro */
      background:#ecfdf5;              /* fondo verde muy claro */
      color:var(--accent);             /* texto verde */
      padding:.25rem .6rem; border-radius:999px; font-size:.9rem; cursor:pointer; user-select:none
    }
    .chip.active{background:#dcfce7; border-color:#86efac}

    /* ====== Grid ====== */
    .pdf-grid{ display:grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap:1rem; padding:1.25rem 0 2rem; }
    @media (max-width: 480px){ .pdf-grid{ grid-template-columns: 1fr; } }

    .pdf-item{ background:var(--surface); border:1px solid var(--line); border-radius:var(--radius); box-shadow:var(--shadow); overflow:hidden; transition: transform var(--trans), box-shadow var(--trans);}
    .pdf-item.hide{ display:none !important; }
    .pdf-item:hover{ transform: translateY(-2px); box-shadow:0 18px 30px rgba(2,6,23,.10), 0 4px 14px rgba(2,6,23,.06); }

    .preview{ position:relative; background:linear-gradient(180deg,#f0f7f3,#e9f7ee); min-height:240px }
    .pdf-embed{ width:100%; height:420px; border:0; display:block; background:#f0f3f7; }
    @media (max-width: 576px){ .pdf-embed{ height:360px; } }
    .preview .hint{position:absolute; inset:auto 12px 12px auto; background:rgba(255,255,255,.85); border:1px solid var(--line); border-radius:999px; padding:.25rem .6rem; font-size:.8rem; color:var(--muted)}

    .pdf-meta{ display:flex; flex-direction:column; gap:.6rem; padding:.9rem .9rem 1rem; }
    .pdf-name{ font-weight:600; line-height:1.35; word-break:break-word }
    .badge-tag{
      background:#ecfdf5;               /* verde claro */
      border:1px solid #bbf7d0;         /* borde verde claro */
      color:var(--accent);              /* texto verde */
      border-radius:999px; padding:.15rem .5rem; font-size:.8rem;
    }
    .tag-row{ display:flex; flex-wrap:wrap; gap:.35rem }
    .actions{ display:flex; align-items:center; gap:.5rem; margin-top:.25rem }
    .btn-linklike{
      display:inline-flex; align-items:center; gap:.45rem;
      border:1px solid var(--line); padding:.45rem .75rem; border-radius:10px;
      background:#fff; text-decoration:none; color:var(--accent); font-weight:600;
    }
    .btn-linklike:hover{ background:#f1fcf5; border-color:#cce3d3; }

    .empty{display:none; border:1px dashed var(--line); border-radius:12px; padding:2rem; text-align:center; color:var(--muted); background:#fff}

    footer{padding:2rem 0; color:var(--muted); font-size:.95rem}
  </style>
</head>
<body>
  <!-- ====== Header ====== -->
  <header class="site-header">
    <div class="container">
      <div class="mast">
        <div class="brand">
          <a href="index.html" aria-label="Ir al inicio"><img src="images/Logo EAM.png" alt="EAM logo" loading="eager" decoding="async" fetchpriority="high"></a>
          <div>
            <div class="title">Enciclopedia de Animales Mexicanos</div>
            <div class="sub">Biblioteca de PDFs</div>
          </div>
        </div>
        <nav class="nav" aria-label="Navegación principal">
          <a href="index.html">Inicio</a>
          <a href="about.html">Nosotros</a>
          <a href="service.html">Especies</a>
          <a href="gallery.html">Galería</a>
          <a href="testimonial.html">Descargas </a>
          <a href="contact.html">Contacto</a>
          <a href="humanidad-animalidad.html">Animalidad y Humanidad</a>
        </nav>
      </div>
    </div>
  </header>

  <!-- ====== Hero / Head ====== -->
  <section class="hero">
    <div class="container hero-inner">
      <h1>PDFs listos para consultar</h1>
      <p id="stat">Cargando colección…</p>

      <div class="toolbar" role="search">
        <label class="search" for="q" title="Buscar por nombre o etiquetas">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M21 21l-4.35-4.35" stroke="#64748b" stroke-width="2" stroke-linecap="round"/><circle cx="10.5" cy="10.5" r="6.5" stroke="#64748b" stroke-width="2"/></svg>
          <input id="q" placeholder="Buscar por nombre o etiquetas (ej. convocatoria, aves, 2025)" autocomplete="off"/>
          <span class="kbd" aria-hidden="true">/</span>
        </label>
        <div class="tools">
          <select id="sort" class="select" aria-label="Ordenar resultados">
            <option value="az">Nombre (A–Z)</option>
            <option value="za">Nombre (Z–A)</option>
          </select>
          <button id="clearBtn" class="btn" type="button" title="Limpiar filtros">Limpiar</button>
          <span id="count" class="" aria-live="polite"></span>
        </div>
      </div>

      <div id="chipBar" class="chips" aria-label="Filtrar por etiquetas"></div>
    </div>
  </section>

  <main class="container">
    <section id="grid" class="pdf-grid" aria-live="polite">
      <!-- ====== Ejemplos (duplica estos <article> y ajusta data-*) ====== -->
      <article class="pdf-item" data-name="Convocatoria Fm.pdf" data-tags="convocatoria, 2025">
        <div class="preview">
          <iframe class="pdf-embed lazy-embed" title="Vista previa de Convocatoria Fm.pdf" data-src="Convocatoria%20Fm.pdf#view=FitH" aria-label="Vista previa PDF"></iframe>
          <span class="hint">Carga inteligente</span>
        </div>
        <div class="pdf-meta">
          <div class="pdf-name">Convocatoria Fm.pdf</div>
          <div class="tag-row">
            <span class="badge-tag">convocatoria</span>
            <span class="badge-tag">2025</span>
          </div>
          <div class="actions">
            <a class="btn-linklike" href="Convocatoria%20Fm.pdf" target="_blank" rel="noopener">Abrir</a>
            <a class="btn-linklike" href="Convocatoria%20Fm.pdf" download="Convocatoria Fm.pdf">Descargar</a>
          </div>
        </div>
      </article>

      <article class="pdf-item" data-name="Convocatoria Fm (copia).pdf" data-tags="convocatoria, revisión">
        <div class="preview">
          <iframe class="pdf-embed lazy-embed" title="Vista previa de Convocatoria Fm (copia).pdf" data-src="Convocatoria%20Fm.pdf#view=FitH" aria-label="Vista previa PDF"></iframe>
          <span class="hint">Carga inteligente</span>
        </div>
        <div class="pdf-meta">
          <div class="pdf-name">Convocatoria Fm (copia).pdf</div>
          <div class="tag-row">
            <span class="badge-tag">convocatoria</span>
            <span class="badge-tag">revisión</span>
          </div>
          <div class="actions">
            <a class="btn-linklike" href="Convocatoria%20Fm.pdf" target="_blank" rel="noopener">Abrir</a>
            <a class="btn-linklike" href="Convocatoria%20Fm.pdf" download="Convocatoria Fm (copia).pdf">Descargar</a>
          </div>
        </div>
      </article>
      <!-- ====== /Ejemplos ====== -->
    </section>

    <div id="empty" class="empty">Sin resultados. Ajusta la búsqueda o quita filtros.</div>
  </main>

  <footer>
    <div class="container">
      <div>© <span id="year"></span> Enciclopedia de Animales Mexicanos · Organización educativa sin fines de lucro.</div>
    </div>
  </footer>

  <script>
    // ====== Utilidades ======
    const norm = s => (s||"")
      .toString()
      .normalize('NFD')
      .replace(/[\u0300-\u036f]/g,'')  // quita acentos
      .toLowerCase()
      .trim();

    const $ = sel => document.querySelector(sel);
    const $$ = sel => Array.from(document.querySelectorAll(sel));

    const input = $('#q');
    const grid  = $('#grid');
    const count = $('#count');
    const clear = $('#clearBtn');
    const sortSel = $('#sort');
    const chipBar = $('#chipBar');
    const emptyEl = $('#empty');
    const stat = $('#stat');

    // ====== Lazy load de iframes PDF ======
    const lazyObserver = ('IntersectionObserver' in window) ? new IntersectionObserver((entries, obs)=>{
      for (const e of entries){
        if (e.isIntersecting){
          const el = e.target; const src = el.getAttribute('data-src');
          if(src){ el.setAttribute('src', src); el.removeAttribute('data-src'); }
          obs.unobserve(el);
        }
      }
    }, {rootMargin: '200px'}) : null;

    function hydrateLazy(){
      $$('.lazy-embed[data-src]').forEach(el=>{
        if(lazyObserver){ lazyObserver.observe(el); } else { el.setAttribute('src', el.getAttribute('data-src')); }
      });
    }

    // ====== Chips dinámicos a partir de data-tags ======
    const selectedTags = new Set();
    function buildChips(){
      const tagMap = new Map();
      $$('.pdf-item').forEach(it=>{
        const tags = (it.getAttribute('data-tags')||'')
          .split(',').map(t=>t.trim()).filter(Boolean);
        for(const t of tags){ tagMap.set(t, (tagMap.get(t)||0)+1); }
      });
      chipBar.innerHTML = '';
      [...tagMap.keys()].sort((a,b)=> a.localeCompare(b,'es',{sensitivity:'base'})).forEach(tag=>{
        const chip = document.createElement('button');
        chip.type = 'button';
        chip.className = 'chip';
        chip.textContent = `${tag}`;
        chip.setAttribute('aria-pressed','false');
        chip.addEventListener('click', ()=>{
          if(selectedTags.has(tag)){ selectedTags.delete(tag); chip.classList.remove('active'); chip.setAttribute('aria-pressed','false'); }
          else { selectedTags.add(tag); chip.classList.add('active'); chip.setAttribute('aria-pressed','true'); }
          applyFilter();
        });
        chipBar.appendChild(chip);
      });
    }

    // ====== Ordenar ======
    function sortItems(){
      const items = $$('.pdf-item');
      const mode = sortSel.value;
      const dir = (mode === 'az') ? 1 : -1;
      items.sort((a,b)=>{
        const na = norm(a.getAttribute('data-name'));
        const nb = norm(b.getAttribute('data-name'));
        return na.localeCompare(nb,'es') * dir;
      }).forEach(el=>grid.appendChild(el));
    }

    // ====== Filtrar (texto + tags) ======
    function applyFilter(){
      const needle = norm(input.value);
      const items = $$('.pdf-item');
      let visible = 0;

      for (const it of items) {
        const name = norm(it.getAttribute('data-name'));
        const tagsRaw = it.getAttribute('data-tags')||'';
        const tagsNorm = norm(tagsRaw);

        const hitText = !needle || name.includes(needle) || tagsNorm.includes(needle);
        const hitTag = selectedTags.size===0 || [...selectedTags].some(t=> tagsRaw.split(',').map(s=>s.trim()).includes(t));

        const show = hitText && hitTag;
        it.classList.toggle('hide', !show);
        if (show) visible++;
      }
      count.textContent = `${visible} documento${visible===1?'':'s'}`;
      emptyEl.style.display = visible ? 'none' : 'block';
      stat && (stat.textContent = `Colección: ${items.length} documento${items.length===1?'':'s'}`);
    }

    // ====== UX ======
    function debounce(fn, ms){ let t; return (...a)=>{ clearTimeout(t); t=setTimeout(()=>fn(...a), ms); } }

    input.addEventListener('input', debounce(applyFilter, 120));
    input.addEventListener('keydown', (e)=>{ if(e.key==='Enter'){ e.preventDefault(); } });
    clear.addEventListener('click', ()=>{ input.value=''; selectedTags.clear(); $$('.chip.active').forEach(c=>{ c.classList.remove('active'); c.setAttribute('aria-pressed','false'); }); applyFilter(); input.focus(); });
    sortSel.addEventListener('change', ()=>{ sortItems(); });

    // Acceso rápido: / para enfocar búsqueda, Esc para limpiar
    window.addEventListener('keydown', (e)=>{
      if (e.key === '/' && document.activeElement !== input){ e.preventDefault(); input.focus(); }
      if (e.key === 'Escape'){ clear.click(); }
    });

    // Inicio
    (function init(){
      document.querySelector('#year') && (document.querySelector('#year').textContent = new Date().getFullYear());
      buildChips();
      sortItems();
      applyFilter();
      hydrateLazy();
    })();
  </script>
</body>
</html>
